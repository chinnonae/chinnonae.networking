[NetDev]
Name={{ networkd_wg_ifname }}
Kind=wireguard
Description=Wireguard Mesh

[WireGuard]
{% if listen_port is defined %}
ListenPort={{ listen_port }}
PrivateKey={{ private_key }}

{% for peer in peers %}
[WireGuardPeer]
PublicKey={{ peer.public_key }}
{% for ips in peer.allowed_ips %}
AllowedIPS={{ ips }}
{% endfor %}
{% endfor %}
